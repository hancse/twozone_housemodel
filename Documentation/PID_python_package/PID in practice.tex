\section{PID in practice.}
% Implement PID in practice
The Ideal and parallel PID in equation (1) and (2) can be easily converted from one to another with  $K_i = \frac{Kc}{T_i}$ and $K_d = \frac{Kc}{T_d}$.

Let Consider the independent PID equation (parallel):
\begin{equation}
\label{eqn:4}
     CO = K_p\cdot e + K_i\int e\cdot dt +K_d\cdot\frac{de}{dt}
\end{equation}

Where CO is the controller output, e=SP-PV, SP is the setpoint, PV the process variable (system output). Differentiating both sides of [4] gives:

\begin{equation}
\label{eqn:5}
    dCO = K_p\cdot de + K_i\cdot e \cdot dt + K_d\frac{d(de)}{dt}
\end{equation}

Using difference to approximate the differential we get discrete PID equation.

\begin{equation}
\label{eqn:6}
    CO(t) = CO(t-1) + K_p[e(t) - e(t-1)] + K_i\cdot T \cdot e(t) + \frac{K_d}{T}[e(t) - 2e(t)-1) + e(t-2)]
\end{equation}

Where T is the sampling period. The D-term of this equation contains set point and changes in set point may cause an unwanted change in CO (a Dirac function \cite{Delta_Function}, some time call derivative Kick ). Remove set point from D-term we get equation [6] (e = SP - PV, de = dSP -dPV, when SP is constant de = dPV).

\begin{equation}
\label{eqn:7}
    CO(t) = CO(t-1) + K_p[e(t) - e(t-1)] + K_i\cdot T \cdot e(t) + \frac{K_d}{T}[PV(t) - 2PV(t)-1) + PV(t-2)]
\end{equation}

Many industrial PID controllers use equation [6] (e.g. Allen Bradley PLCs). However, if we remove set point from both P-term and D-term, we get a still better PID equation [7].

\begin{equation}
\label{eqn:8}
    CO(t) = CO(t-1) + K_p[PV(t) - PV(t-1)] + K_i\cdot T \cdot e(t) + \frac{K_d}{T}[PV(t) - 2PV(t)-1) + PV(t-2)]
\end{equation}

To implement PID controller in practice a few more things need to be addressed.

\begin{itemize}
    \item Windup protection.
    \item On the fly tuning: a good PID controller allow changing the parameters when the process is running.
    \item Online Controller Switching or bumpless transfer:  allow smooth transition from one type of controller to another (ex: switch from PID to manual control, or MPC).
    \item 2 DOF (degree of freedom) PID (Optional) 
\end{itemize}

A good explanation on the practical problems and solution can be found in the the blog series improving the Beginnerâ€™s PID by Brettbeauregard \cite{Improving_PID}.


\newpage
